<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GymCompass - Regisztráció</title>
  <link rel="stylesheet" href="./style.css">
  <style>
    .footer {
      position: absolute;
      bottom: 0px;
      width: 100%;
    }

    #hero-bg {
      z-index: -1;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  </style>
</head>
<body>

    <!-- Navbar ami desktopon jo meretu -->
    <section id="">
        <img id="hero-bg" src="./grafika/1-bg-svg.svg" alt="">
        <nav class="navbar roboto-roboto">

            <a id="navlogolink" href="./index.html"><div class="nav-ossz"><img src="./grafika/logo-svg.svg" alt="logo" class="nav-logo"> <span class="nav-logo-txt">GymCompass</span></div></a>
            <div class="menu-icon" onclick="toggleNavHidden(menu)">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#F6F4F4">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                        <path d="M5 7H19" stroke="#F6F4F4" stroke-width="3" stroke-linecap="round"
                            stroke-linejoin="round">
                        </path>
                        <path d="M5 12L19 12" stroke="#F6F4F4" stroke-width="3" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                        <path d="M5 17L19 17" stroke="#F6F4F4" stroke-width="3" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                    </g>
                </svg>
            </div>
            <div class="nav-links">
            <section class="nav-section ">
                <a href="./edzotermek.html">Edzőtermek</a>
                <a href="./kapcsolat.html">Kapcsolat</a>
                <a href="./rolunk.html">Rólunk</a>





            </section>
            <section>
                <a href="./registracio.html"><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M12.12 12.78C12.05 12.77 11.96 12.77 11.88 12.78C10.12 12.72 8.71997 11.28 8.71997 9.50998C8.71997 7.69998 10.18 6.22998 12 6.22998C13.81 6.22998 15.28 7.69998 15.28 9.50998C15.27 11.28 13.88 12.72 12.12 12.78Z" stroke="#ff7517" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M18.74 19.3801C16.96 21.0101 14.6 22.0001 12 22.0001C9.40001 22.0001 7.04001 21.0101 5.26001 19.3801C5.36001 18.4401 5.96001 17.5201 7.03001 16.8001C9.77001 14.9801 14.25 14.9801 16.97 16.8001C18.04 17.5201 18.64 18.4401 18.74 19.3801Z" stroke="#ff7517" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="#ff7517" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg></a>

            </section>



    </section>
    </nav>

    <!-- Nav ami mobilon jo-->
    <section class="nav-section-mobile nav-hidden" id="nav-section-mobile">
        <ul class="nav-links-mobile">
            <li><a href="./edzotermek.html">Edzőtermek</a></li>
            <li><a href="./kapcsolat.html">Kapcsolat</a></li>
            <li><a href="./rolunk.html">Rólunk</a></li>
            <li><a href="./registracio.html"><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M12.12 12.78C12.05 12.77 11.96 12.77 11.88 12.78C10.12 12.72 8.71997 11.28 8.71997 9.50998C8.71997 7.69998 10.18 6.22998 12 6.22998C13.81 6.22998 15.28 7.69998 15.28 9.50998C15.27 11.28 13.88 12.72 12.12 12.78Z" stroke="#ff7517" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M18.74 19.3801C16.96 21.0101 14.6 22.0001 12 22.0001C9.40001 22.0001 7.04001 21.0101 5.26001 19.3801C5.36001 18.4401 5.96001 17.5201 7.03001 16.8001C9.77001 14.9801 14.25 14.9801 16.97 16.8001C18.04 17.5201 18.64 18.4401 18.74 19.3801Z" stroke="#ff7517" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="#ff7517" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg></a></li>


        </ul>
    </section>

  <main class="content" >
    <div class=" container form-section hidden" id="register">

      <form class="registration-form form-group " >
                        <h2 class="section-title">Regisztráció:</h2>
        <label for="email">E-mail:</label>
        <input type="text" id="email" name="email" required>

        <label for="name">Felhasználónév:</label>
        <input type="text" id="name" name="name" required>

        
        <label for="name">Teljes Név::</label>
        <input type="text" id="name" name="name" required>

        <label for="password">Jelszó:</label>
        <input type="password" id="password" name="password" required>

        <label for="password2">Jelszó ismét:</label>
        <input type="password" id="password2" name="password2" required>
        <div class="alert hidden"></div>
        <button type="button" class="btn-submit">Regisztráció</button>
        <h3 class="subsection-title-orange">Van profilja? <span class="reg-span-link" onclick="ShowLogin()">Belépés</span></h3>

        
      </form>
    </div>

        <div class=" container form-section"id="login" >

      <form class="registration-form form-group" >
                        <h2 class="section-title">Belépés:</h2>
        <label for="email">E-mail:</label>
        <input type="text" id="email" name="email" required>

        <label for="name">Felhasználónév:</label>
        <input type="text" id="name" name="name" required>

        <label for="password">Jelszó:</label>
        <input type="password" id="password" name="password" required>

        <div class="alert hidden"></div>

        <button type="button" class="btn-submit">Bejelentkezés</button>
        <h3 class="subsection-title-orange">Nincs profilja? <span class="reg-span-link" onclick="ShowRegister()">Regisztráció</span></h3>

      </form>
    </div>

    <div class="container form-section" id="loggedinuser">
        <h2 class="section-title">Bejelentkezve mint:</h2>
        <div class="user-data-reg" id="user-data-reg">
            

        </div>
        <button onclick="logout()" class="btn-submit">Kijelentkezés</button>
    </div>


  </main>

        <section class="footer">
            <div>
            <img src="./grafika/logo-text-svg.svg.png" alt="logo">
            </div>
            <ul>
                <li><a href="./index.html">Főoldal</a></li>
                <li><a href="./kapcsolat.html">Kapcsolat</a></li>
                <li><a href="./edzotermek.html">Edzőtermek</a></li>
                <li><a href="./rolunk.html">Rólunk</a></li>
                <li><a href="./registracio.html">Regisztráció</a></li>
            
            </ul>
        </section>
    </div>
</body>
<script>

    const user = JSON.parse(localStorage.getItem("logged_in_user")) || null;

function logout() {
    localStorage.removeItem("logged_in_user")
}

const menu = document.getElementById("nav-section-mobile");
function toggleNavHidden(element) {
    element.classList.toggle("nav-hidden");
}

const reg = document.getElementById("register");
const log = document.getElementById("login");

function ShowRegister() {
    log.classList.add("hidden");
    reg.classList.remove("hidden");
}

function ShowLogin() {
    log.classList.remove("hidden");
    reg.classList.add("hidden");
}

function showAlert(message, color = "red") {
    const alertBox = document.querySelectorAll(".alert");
    alertBox.forEach(element => {
        console.log(element)
            element.textContent = message;
            element.classList.remove("hidden");
            element.style.border = "2px solid " + color;
            element.style.color = color;
    setTimeout(() => {
        
        element.classList.add("hidden");
        element.style.border = "none";
        element.textContent = "";
    }, 5000);
    });

}


const registerForm = document.querySelector('#register form');
registerForm.querySelector('.btn-submit').addEventListener("click", function() {
    const email = registerForm.querySelector('input[name="email"]').value.trim();
    const username = registerForm.querySelectorAll('input[name="name"]')[0].value.trim();
    const fullname = registerForm.querySelectorAll('input[name="name"]')[1].value.trim();
    const password = registerForm.querySelector('input[name="password"]').value.trim();
    const password2 = registerForm.querySelector('input[name="password2"]').value.trim();

    if (!email || !username || !fullname || !password || !password2) {
        showAlert("Kérlek tölts ki minden mezőt!");
        return;
    }

    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        showAlert("Az e-mail cím formátuma nem megfelelő!");
        return;
    }

    if (username.length < 4) {
        showAlert("A felhasználónév legalább 4 karakter legyen!");
        return;
    }

    if (password.length < 6) {
        showAlert("A jelszó legalább 6 karakter legyen!");
        return;
    }

    if (password !== password2) {
        showAlert("A két jelszó nem egyezik!");
        return;
    }


    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith("user_")) {
            const userData = JSON.parse(localStorage.getItem(key));
            if (userData.email === email) {
                showAlert("Ez az email már regisztrálva van!");
                return;
            }
            if (userData.username === username) {
                showAlert("Ez a felhasználónév már foglalt!");
                return;
            }
        }
    }

    const newUser = { email, username, fullname, password };
    localStorage.setItem("user_" + username, JSON.stringify(newUser));

    showAlert("Regisztráció sikeres!", "green");

    ShowLogin();
});


const loginForm = document.querySelector('#login form');
loginForm.querySelector('.btn-submit').addEventListener("click", function() {
    const emailInput = loginForm.querySelector('input[name="email"]').value.trim();
    const usernameInput = loginForm.querySelectorAll('input[name="name"]')[0].value.trim();
    const passwordInput = loginForm.querySelector('input[name="password"]').value.trim();

    if (!emailInput || !usernameInput || !passwordInput) {
        showAlert("Kérlek tölts ki minden mezőt!");
        return;
    }

    let foundUser = null;

    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith("user_")) {
            const userData = JSON.parse(localStorage.getItem(key));
            if ((userData.email === emailInput || userData.username === usernameInput)
                && userData.password === passwordInput) {
                foundUser = userData;
                break;
            }
        }
    }

    if (!foundUser) {
        showAlert("Hibás email/felhasználónév vagy jelszó!");
        return;
    }

    localStorage.setItem("logged_in_user", JSON.stringify(foundUser));

    showAlert("Sikeres bejelentkezés!", "green");

  
});

if (user) {
    reg.classList.add("hidden");
    log.classList.add("hidden");
    const loggedin = document.getElementById("user-data-reg")
    loggedin.innerHTML += `
                <p class="user-info"><strong>Felhasználónév:</strong> ${user.username}</p>
            <p class="user-info"><strong>Teljes Név:</strong> ${user.fullname}</p>
            <p class="user-info"><strong>E-mail:</strong> ${user.email}</p>
            `
} else {
  ShowLogin();
  const loggedinuser = document.getElementById("loggedinuser")
  loggedinuser.classList.add("hidden")
}

</script>

</body>
</html>
